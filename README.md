# YoTest

YoTest was created to test the ability to deploy an Excel task-pane add-in based on code produced by the [Yo Office generator](https://github.com/OfficeDev/generator-office) for the Angular/TypeScript framework.

## Problems

The following problems were encountered (and fixed) in the code generated by Yo Office.

**Problem:** The add-in's icon did not appear during sideloading (from the Insert tab).  It appeared with the _Show Taskpane_ button for the add-in on Excel's _Home_ tab when testing with _npm run_, but not when running a production build with the manifest _yotest.xml_.

**Fix:** Add an entry to the _CopyWebpackPlugin_ in _webpack.config.js_ to include the _assets_ directory in the production build.

**Problem:** The Angular _*ngFor_ directive is recognized when testing with _npm run_, but not when running a production build.  The console log for the task pane displays the error messages

    Can't bind to 'ngforOf' since it isn't a known property of 'li'.

    Property binding ngforOf not used by any directive on an embedded template. Make sure that the property name is spelled correctly and all directives are listed in the "@NgModule.declarations".

**Fix:** Pending.  Tried declaring the Angular _CommonModule_  in _@NgModule.declarations_ in _app.module.ts_ and importing it in _app.component.ts_, but the same error messages still appeared.

## Customizations

The following customizations are needed when developing an add-in using the code generated by Yo Office.

### manifest.xml

Generate a new _&lt;Id&gt;_.  Change the provider and display names, description, AppDomain, amd GetStarted strings.

Make a copy of the manifest in which all occurrences of <https://localhost:3000> are replaced by the URL for a directory containing the production code generated in the folder _dist_ by _npm run build_.

For YoTest, the folder _dist_ was uploaded to _stageonesoftware.com_ and renamed to _YoTest_.  The manifest _yotest.xml_ uses the URL <https://stageonesoftware.com/YoTest> instead of <https://localhost:3000>.

### package.json

Change the name and repository URL.

### app.component.ts

Change the code in the _run_ method.  If the _run_ method generates content for the task pane, create a constructor that calls _run_ to generate that content before the task pane is displayed.

YoTest was customized as follows:

- changed code that highlights and logs the selected range to set an instance variable instead
- added a constructor to ensure this variable is set before the task pane is displayed
- added a sample list of strings

### app.component.html

Replace the content.  In YoTest, this involved

- shortening the content
- displaying the value _{{selectedRange}}_ of the new instance variable
- adding an _*ngFor_ element to display the sample list of strings

### webpack.config.js

Add an entry to the _CopyWebpackPlugin_ to copy the _assets_ directory.

Add other (to be determined) entries to enable the use of Angular directives and selectors in a production build.

## Copyright

Copyright (c) 2020 Stage One Software. All rights reserved.
